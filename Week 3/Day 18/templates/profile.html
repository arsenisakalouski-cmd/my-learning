{% extends "base.html" %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - {{ user.username }}{% endblock %}

{% block content %}
    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-avatar">
                {{ user.username[0].upper() }}
            </div>
            <div class="profile-info">
                <h1>{{ user.username }}</h1>
                <p class="profile-email">üìß {{ user.email }}</p>
                <p class="profile-date">üìÖ –ù–∞ —Å–∞–π—Ç–µ —Å {{ user.created_at | timeago }}</p>
            </div>
        </div>
        
        <div class="profile-stats">
            <div class="stat-item">
                <div class="stat-value">{{ posts | length }}</div>
                <div class="stat-label">–ü–æ—Å—Ç–æ–≤</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">
                    {% set total_views = namespace(count=0) %}
                    {% for post in posts %}
                        {% set total_views.count = total_views.count + post.views %}
                    {% endfor %}
                    {{ total_views.count }}
                </div>
                <div class="stat-label">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
            </div>
        </div>
        
        <div class="profile-posts">
            <h2>–ú–æ–∏ –ø–æ—Å—Ç—ã</h2>
            
            {% if posts %}
                <div class="posts-list">
                    {% for post in posts %}
                        <div class="post-item">
                            <div class="post-item-header">
                                <h3>
                                    <a href="{{ url_for('view_post', post_id=post.id) }}">
                                        {{ post.title }}
                                    </a>
                                </h3>
                                <div class="post-item-meta">
                                    <span>üëÅÔ∏è {{ post.views }}</span>
                                    <span>üïê {{ post.created_at | timeago }}</span>
                                </div>
                            </div>
                            <p class="post-item-excerpt">
                                {{ post.content[:100] }}...
                            </p>
                            <div class="post-item-actions">
                                <a href="{{ url_for('view_post', post_id=post.id) }}" class="btn-small">
                                    –ß–∏—Ç–∞—Ç—å
                                </a>
                                <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn-small btn-edit">
                                    ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</p>
                    <a href="{{ url_for('new_post') }}" class="btn btn-primary">
                        –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}