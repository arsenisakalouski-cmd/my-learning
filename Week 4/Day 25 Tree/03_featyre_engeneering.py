import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import r2_score

sns.set_theme()
np.random.seed(42)

print("="*60)
print("FEATURE ENGINEERING - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
print("="*60)


n_–¥–æ–º–æ–≤ = 500

–¥–∞–Ω–Ω—ã–µ = {
    '–ü–ª–æ—â–∞–¥—å': np.random.randint(50, 200, n_–¥–æ–º–æ–≤),
    '–ö–æ–º–Ω–∞—Ç—ã': np.random.randint(1, 5, n_–¥–æ–º–æ–≤),
    '–≠—Ç–∞–∂': np.random.randint(1, 20, n_–¥–æ–º–æ–≤),
    '–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏': np.random.randint(1980, 2024, n_–¥–æ–º–æ–≤),
}

# –†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (—Å–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞)
—Ü–µ–Ω–∞ = (
    –¥–∞–Ω–Ω—ã–µ['–ü–ª–æ—â–∞–¥—å'] * 0.15 +           # –ø–ª–æ—â–∞–¥—å –≤–∞–∂–Ω–∞
    –¥–∞–Ω–Ω—ã–µ['–ö–æ–º–Ω–∞—Ç—ã'] * 1.5 +             # –∫–æ–º–Ω–∞—Ç—ã –≤–∞–∂–Ω—ã
    (–¥–∞–Ω–Ω—ã–µ['–ü–ª–æ—â–∞–¥—å'] / –¥–∞–Ω–Ω—ã–µ['–ö–æ–º–Ω–∞—Ç—ã']) * 0.5 +  # –ø–ª–æ—â–∞–¥—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É!
    (2024 - –¥–∞–Ω–Ω—ã–µ['–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏']) * (-0.1) +  # —Å—Ç–∞—Ä—ã–µ –¥–æ–º–∞ –¥–µ—à–µ–≤–ª–µ
    np.random.normal(0, 2, n_–¥–æ–º–æ–≤)
)

–¥–∞–Ω–Ω—ã–µ['–¶–µ–Ω–∞'] = —Ü–µ–Ω–∞

df = pd.DataFrame(–¥–∞–Ω–Ω—ã–µ)

print(f"\n–°–æ–∑–¥–∞–Ω–æ {len(df)} –¥–æ–º–æ–≤")
print("\n–ü–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏:")
print(df.head())


print("\n" + "="*60)
print("–í–ê–†–ò–ê–ù–¢ 1: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏")
print("="*60)

# –¢–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
X_original = df[['–ü–ª–æ—â–∞–¥—å', '–ö–æ–º–Ω–∞—Ç—ã', '–≠—Ç–∞–∂', '–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏']].values
y = df['–¶–µ–Ω–∞'].values

X_train, X_test, y_train, y_test = train_test_split(
    X_original, y, test_size=0.2, random_state=42
)

# –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å
rf_original = RandomForestRegressor(n_estimators=100, random_state=42)
rf_original.fit(X_train, y_train)

y_pred_original = rf_original.predict(X_test)
r2_original = r2_score(y_test, y_pred_original)

print(f"R¬≤ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏: {r2_original:.3f}")



# ============================================
# –í–ê–†–ò–ê–ù–¢ 2: –° –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
# ============================================

print("\n" + "="*60)
print("–í–ê–†–ò–ê–ù–¢ 2: –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏")
print("="*60)

# –°–æ–∑–¥–∞—ë–º –ù–û–í–´–ï –ø—Ä–∏–∑–Ω–∞–∫–∏
df['–ü–ª–æ—â–∞–¥—å_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É'] = df['–ü–ª–æ—â–∞–¥—å'] / df['–ö–æ–º–Ω–∞—Ç—ã']
"""
–ü–ª–æ—â–∞–¥—å_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É - –≤–∞–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫!

–ü—Ä–∏–º–µ—Ä:
–î–æ–º 1: 100–º¬≤, 4 –∫–æ–º–Ω–∞—Ç—ã ‚Üí 25–º¬≤ –Ω–∞ –∫–æ–º–Ω–∞—Ç—É (–º–∞–ª–µ–Ω—å–∫–∏–µ –∫–æ–º–Ω–∞—Ç—ã)
–î–æ–º 2: 100–º¬≤, 2 –∫–æ–º–Ω–∞—Ç—ã ‚Üí 50–º¬≤ –Ω–∞ –∫–æ–º–Ω–∞—Ç—É (–±–æ–ª—å—à–∏–µ –∫–æ–º–Ω–∞—Ç—ã)

–î–æ–º 2 –¥–æ—Ä–æ–∂–µ! –ú–æ–¥–µ–ª—å —ç—Ç–æ –ø–æ–π–º—ë—Ç.
"""

df['–í–æ–∑—Ä–∞—Å—Ç_–¥–æ–º–∞'] = 2024 - df['–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏']
"""
–í–æ–∑—Ä–∞—Å—Ç_–¥–æ–º–∞ - –ø–æ–Ω—è—Ç–Ω–µ–µ —á–µ–º –≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏

–ë—ã–ª–æ: –ì–æ–¥ 2020
–°—Ç–∞–ª–æ: –í–æ–∑—Ä–∞—Å—Ç 4 –≥–æ–¥–∞

–ú–æ–¥–µ–ª–∏ –ø—Ä–æ—â–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º!
"""

df['–ü–ª–æ—â–∞–¥—å_√ó_–ö–æ–º–Ω–∞—Ç—ã'] = df['–ü–ª–æ—â–∞–¥—å'] * df['–ö–æ–º–Ω–∞—Ç—ã']
"""
–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ë–æ–ª—å—à–∞—è –ø–ª–æ—â–∞–¥—å –ò –º–Ω–æ–≥–æ –∫–æ–º–Ω–∞—Ç = –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ!
–ú–∞–ª–µ–Ω—å–∫–∞—è –ø–ª–æ—â–∞–¥—å –ò –º–∞–ª–æ –∫–æ–º–Ω–∞—Ç = –¥—ë—à–µ–≤–æ
"""

df['–í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂'] = (df['–≠—Ç–∞–∂'] > 10).astype(int)
"""
–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –∏–∑ —á–∏—Å–ª–æ–≤–æ–≥–æ

–≠—Ç–∞–∂ 15 ‚Üí –í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂ = 1 (–¥–∞)
–≠—Ç–∞–∂ 3  ‚Üí –í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂ = 0 (–Ω–µ—Ç)

–ò–Ω–æ–≥–¥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–∞–∂–Ω–µ–µ —Ç–æ—á–Ω–æ–≥–æ —á–∏—Å–ª–∞!
"""

print("\n–ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å–æ–∑–¥–∞–Ω—ã:")
print("  1. –ü–ª–æ—â–∞–¥—å_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É = –ü–ª–æ—â–∞–¥—å / –ö–æ–º–Ω–∞—Ç—ã")
print("  2. –í–æ–∑—Ä–∞—Å—Ç_–¥–æ–º–∞ = 2024 - –ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏")
print("  3. –ü–ª–æ—â–∞–¥—å_√ó_–ö–æ–º–Ω–∞—Ç—ã = –ü–ª–æ—â–∞–¥—å * –ö–æ–º–Ω–∞—Ç—ã")
print("  4. –í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂ = 1 –µ—Å–ª–∏ —ç—Ç–∞–∂ > 10, –∏–Ω–∞—á–µ 0")

print("\n–ü—Ä–∏–º–µ—Ä—ã –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:")
print(df[['–ü–ª–æ—â–∞–¥—å', '–ö–æ–º–Ω–∞—Ç—ã', '–ü–ª–æ—â–∞–¥—å_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É', 
         '–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏', '–í–æ–∑—Ä–∞—Å—Ç_–¥–æ–º–∞']].head())

# –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—Å—Ç–∞—Ä—ã–µ + –Ω–æ–≤—ã–µ)
–ø—Ä–∏–∑–Ω–∞–∫–∏ = ['–ü–ª–æ—â–∞–¥—å', '–ö–æ–º–Ω–∞—Ç—ã', '–≠—Ç–∞–∂', '–ì–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏',
            '–ü–ª–æ—â–∞–¥—å_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É', '–í–æ–∑—Ä–∞—Å—Ç_–¥–æ–º–∞', 
            '–ü–ª–æ—â–∞–¥—å_√ó_–ö–æ–º–Ω–∞—Ç—ã', '–í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂']

X_enhanced = df[–ø—Ä–∏–∑–Ω–∞–∫–∏].values
"""
X_enhanced —Å–æ–¥–µ—Ä–∂–∏—Ç:
- 4 –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞
- 4 –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞
= 8 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Å–µ–≥–æ

–ë–æ–ª—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Üí –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Üí –ª—É—á—à–µ –º–æ–¥–µ–ª—å!
(–Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ - –ø–ª–æ—Ö–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ä–µ–¥—è—Ç)
"""

X_train, X_test, y_train, y_test = train_test_split(
    X_enhanced, y, test_size=0.2, random_state=42
)

# –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
rf_enhanced = RandomForestRegressor(n_estimators=100, random_state=42)
rf_enhanced.fit(X_train, y_train)

y_pred_enhanced = rf_enhanced.predict(X_test)
r2_enhanced = r2_score(y_test, y_pred_enhanced)

print(f"\nR¬≤ —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏: {r2_enhanced:.3f}")


print("\n" + "="*60)
print("–°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
print("="*60)

print(f"\n–ë–µ–∑ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: R¬≤ = {r2_original:.3f}")
print(f"–° –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏:  R¬≤ = {r2_enhanced:.3f}")

—É–ª—É—á—à–µ–Ω–∏–µ = ((r2_enhanced - r2_original) / abs(r2_original)) * 100
print(f"\n–£–ª—É—á—à–µ–Ω–∏–µ: {—É–ª—É—á—à–µ–Ω–∏–µ:.1f}%")

if r2_enhanced > r2_original:
    print("‚úì –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ü–û–ú–û–ì–õ–ò!")
else:
    print("‚úó –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –ø–æ–º–æ–≥–ª–∏")

print("\n" + "="*60)
print("–í–ê–ñ–ù–û–°–¢–¨ –ü–†–ò–ó–ù–ê–ö–û–í:")
print("="*60)

importances = rf_enhanced.feature_importances_
"""
feature_importances_ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
–ù–∞—Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–∞–∂–µ–Ω –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

–ß–∏—Å–ª–æ –æ—Ç 0 –¥–æ 1, —Å—É–º–º–∞ –≤—Å–µ—Ö = 1.0

–ü—Ä–∏–º–µ—Ä:
[0.3, 0.2, 0.1, 0.05, 0.15, 0.1, 0.05, 0.05]
–ü—Ä–∏–∑–Ω–∞–∫ 1 —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π (30%)
–ü—Ä–∏–∑–Ω–∞–∫–∏ 4,7,8 –Ω–∞–∏–º–µ–Ω–µ–µ –≤–∞–∂–Ω—ã (–ø–æ 5%)
"""

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
indices = np.argsort(importances)[::-1]

print("\n–†–µ–π—Ç–∏–Ω–≥ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–æ—Ç –≤–∞–∂–Ω–æ–≥–æ –∫ –Ω–µ–≤–∞–∂–Ω–æ–º—É):")
for i, idx in enumerate(indices, 1):
    print(f"  {i}. {–ø—Ä–∏–∑–Ω–∞–∫–∏[idx]:20s}: {importances[idx]:.3f} ({importances[idx]*100:.1f}%)")


print("\n–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º...")

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# –ì—Ä–∞—Ñ–∏–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ R¬≤
axes[0, 0].bar(['–ë–µ–∑ –Ω–æ–≤—ã—Ö\n–ø—Ä–∏–∑–Ω–∞–∫–æ–≤', '–° –Ω–æ–≤—ã–º–∏\n–ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏'], 
               [r2_original, r2_enhanced],
               color=['red', 'green'], alpha=0.7)
axes[0, 0].set_title('üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞', fontweight='bold')
axes[0, 0].set_ylabel('R¬≤ Score')
axes[0, 0].set_ylim(0, 1)
axes[0, 0].grid(True, alpha=0.3, axis='y')

for i, v in enumerate([r2_original, r2_enhanced]):
    axes[0, 0].text(i, v + 0.02, f'{v:.3f}', 
                    ha='center', fontweight='bold')

# –ì—Ä–∞—Ñ–∏–∫ 2: –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
axes[0, 1].barh(range(len(–ø—Ä–∏–∑–Ω–∞–∫–∏)), importances[indices])
axes[0, 1].set_yticks(range(len(–ø—Ä–∏–∑–Ω–∞–∫–∏)))
axes[0, 1].set_yticklabels([–ø—Ä–∏–∑–Ω–∞–∫–∏[i] for i in indices])
axes[0, 1].set_title('üìà –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤', fontweight='bold')
axes[0, 1].set_xlabel('–í–∞–∂–Ω–æ—Å—Ç—å')
axes[0, 1].grid(True, alpha=0.3, axis='x')

# –ì—Ä–∞—Ñ–∏–∫ 3: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs –†–µ–∞–ª—å–Ω–æ—Å—Ç—å (–±–µ–∑ –Ω–æ–≤—ã—Ö)
axes[1, 0].scatter(y_test, y_pred_original, alpha=0.5, s=30)
axes[1, 0].plot([y_test.min(), y_test.max()], 
                [y_test.min(), y_test.max()], 
                'r--', linewidth=2)
axes[1, 0].set_title(f'–ë–µ–∑ –Ω–æ–≤—ã—Ö (R¬≤={r2_original:.3f})', fontweight='bold')
axes[1, 0].set_xlabel('–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞')
axes[1, 0].set_ylabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞')
axes[1, 0].grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ 4: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs –†–µ–∞–ª—å–Ω–æ—Å—Ç—å (—Å –Ω–æ–≤—ã–º–∏)
axes[1, 1].scatter(y_test, y_pred_enhanced, alpha=0.5, s=30, color='green')
axes[1, 1].plot([y_test.min(), y_test.max()], 
                [y_test.min(), y_test.max()], 
                'r--', linewidth=2)
axes[1, 1].set_title(f'–° –Ω–æ–≤—ã–º–∏ (R¬≤={r2_enhanced:.3f})', fontweight='bold')
axes[1, 1].set_xlabel('–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞')
axes[1, 1].set_ylabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞')
axes[1, 1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# ============================================
# –†–ï–ó–Æ–ú–ï
# ============================================

print("\n" + "="*60)
print("–†–ï–ó–Æ–ú–ï - FEATURE ENGINEERING:")
print("="*60)

print("""
–ß–¢–û –¢–ê–ö–û–ï:
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö

–¢–ò–ü–´ –ù–û–í–´–• –ü–†–ò–ó–ù–ê–ö–û–í:

1. –ö–û–ú–ë–ò–ù–ê–¶–ò–ò:
   –ü–ª–æ—â–∞–¥—å / –ö–æ–º–Ω–∞—Ç—ã = –ø–ª–æ—â–∞–¥—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É
   –ü—Ä–∏–∑–Ω–∞–∫1 * –ü—Ä–∏–∑–Ω–∞–∫2 = –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

2. –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–Ø:
   2024 - –ì–æ–¥ ‚Üí –í–æ–∑—Ä–∞—Å—Ç
   log(–∑–Ω–∞—á–µ–Ω–∏–µ) ‚Üí –ª–æ–≥–∞—Ä–∏—Ñ–º

3. –ö–ê–¢–ï–ì–û–†–ò–ò –ò–ó –ß–ò–°–ï–õ:
   –≠—Ç–∞–∂ > 10 ‚Üí –í—ã—Å–æ–∫–∏–π_—ç—Ç–∞–∂ (–¥–∞/–Ω–µ—Ç)

4. –ê–ì–†–ï–ì–ê–¢–´:
   sum(), mean(), max() –ø–æ –≥—Ä—É–ø–ø–∞–º

–ó–ê–ß–ï–ú:
‚úì –ü–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –Ω–∞–π—Ç–∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏
‚úì –£–ª—É—á—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ 5-30%
‚úì –ò–Ω–æ–≥–¥–∞ –≤–∞–∂–Ω–µ–µ —á–µ–º –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏!

–ö–ê–ö –ü–†–ò–î–£–ú–´–í–ê–¢–¨:
1. –ü–æ–¥—É–º–∞—Ç—å –æ –∑–∞–¥–∞—á–µ (—á—Ç–æ –≤–∞–∂–Ω–æ?)
2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ (—á—Ç–æ —Å–≤—è–∑–∞–Ω–æ?)
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å (feature_importances_)
5. –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ, —É–±—Ä–∞—Ç—å –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–µ

–í–ê–ñ–ù–û:
 –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ train –∏ test —Å–æ–∑–¥–∞–≤–∞—Ç—å –û–î–ò–ù–ê–ö–û–í–û!
""")

print("\n Feature Engineering –æ—Å–≤–æ–µ–Ω!")
print("="*60)