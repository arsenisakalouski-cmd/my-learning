import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeRegressor, DecisionTreeClassifier
from sklearn.tree import plot_tree
from sklearn.metrics import r2_score, accuracy_score


print("\n" + "="*60)
print("–ü–†–ò–ú–ï–† 1: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã (–†–ï–ì–†–ï–°–°–ò–Ø)")
print("="*60)

# –°–æ–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
–æ–ø—ã—Ç = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10])

# –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–¥–µ—Ä–µ–≤–æ —Å–ø—Ä–∞–≤–∏—Ç—Å—è –ª—É—á—à–µ!)
–∑–∞—Ä–ø–ª–∞—Ç–∞ = np.where(–æ–ø—ã—Ç < 3, 
                     30000 + –æ–ø—ã—Ç * 2000,  # –ù–∞—á–∞–ª–æ –∫–∞—Ä—å–µ—Ä—ã - –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç
                     30000 + 3*2000 + (–æ–ø—ã—Ç-3) * 8000)  # –ü–æ—Å–ª–µ 3 –ª–µ—Ç - –±—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç
"""
–í–ê–ñ–ù–û: –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å!

0-3 –≥–æ–¥–∞: –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç (+2000 –≤ –≥–æ–¥)
3+ –ª–µ—Ç: –±—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç (+8000 –≤ –≥–æ–¥)

–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –Ω–µ —Å–ø—Ä–∞–≤–∏—Ç—Å—è!
–î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π - –æ—Ç–ª–∏—á–Ω–æ!
"""

–∑–∞—Ä–ø–ª–∞—Ç–∞ += np.random.normal(0, 2000, len(–æ–ø—ã—Ç))

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
X = –æ–ø—ã—Ç.reshape(-1, 1)
y = –∑–∞—Ä–ø–ª–∞—Ç–∞

print("\n–î–∞–Ω–Ω—ã–µ:")
for o, z in zip(–æ–ø—ã—Ç, –∑–∞—Ä–ø–ª–∞—Ç–∞):
    print(f"  {o} –ª–µ—Ç ‚Üí {z:,.0f} —Ä—É–±")

# –†–∞–∑–¥–µ–ª–∏—Ç—å
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)


print("\n–°–æ–∑–¥–∞—ë–º –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π...")

# –î–µ—Ä–µ–≤–æ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
tree_model = DecisionTreeRegressor(
    max_depth=3,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ = 3 —É—Ä–æ–≤–Ω—è –≤–æ–ø—Ä–æ—Å–æ–≤
    random_state=42
)
"""
max_depth - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞

max_depth=3 –æ–∑–Ω–∞—á–∞–µ—Ç:
  –£—Ä–æ–≤–µ–Ω—å 1: –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
  –£—Ä–æ–≤–µ–Ω—å 2: –≤—Ç–æ—Ä–æ–π –≤–æ–ø—Ä–æ—Å  
  –£—Ä–æ–≤–µ–Ω—å 3: —Ç—Ä–µ—Ç–∏–π –≤–æ–ø—Ä–æ—Å
  ‚Üí –û—Ç–≤–µ—Ç

–ë–æ–ª—å—à–µ –≥–ª—É–±–∏–Ω–∞ = —Å–ª–æ–∂–Ω–µ–µ –¥–µ—Ä–µ–≤–æ = –±–æ–ª—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
–ú–µ–Ω—å—à–µ –≥–ª—É–±–∏–Ω–∞ = –ø—Ä–æ—â–µ –¥–µ—Ä–µ–≤–æ = –º–æ–∂–µ—Ç –Ω–µ–¥–æ–æ–±—É—á–∏—Ç—å—Å—è

–ó–û–õ–û–¢–ê–Ø –°–ï–†–ï–î–ò–ù–ê: 3-5 –¥–ª—è –Ω–∞—á–∞–ª–∞
"""

print("‚úì –î–µ—Ä–µ–≤–æ —Å–æ–∑–¥–∞–Ω–æ")

# –û–±—É—á–∏—Ç—å
tree_model.fit(X_train, y_train)
print("‚úì –î–µ—Ä–µ–≤–æ –æ–±—É—á–µ–Ω–æ")

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
y_pred_tree = tree_model.predict(X_test)

# –û—Ü–µ–Ω–∫–∞
r2_tree = r2_score(y_test, y_pred_tree)
print(f"\nR¬≤ Score: {r2_tree:.3f}")

print("\n–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π...")

from sklearn.linear_model import LinearRegression

linear_model = LinearRegression()
linear_model.fit(X_train, y_train)
y_pred_linear = linear_model.predict(X_test)
r2_linear = r2_score(y_test, y_pred_linear)

print(f"–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è R¬≤: {r2_linear:.3f}")
print(f"–î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π R¬≤: {r2_tree:.3f}")

if r2_tree > r2_linear:
    print("\n‚úì –î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π –õ–£–ß–®–ï –¥–ª—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö!")
else:
    print("\n‚úì –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ª—É—á—à–µ")

# ============================================
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
# ============================================

print("\n–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã...")

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# –ì—Ä–∞—Ñ–∏–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
axes[0].scatter(X, y, alpha=0.6, s=100, label='–î–∞–Ω–Ω—ã–µ')

# –õ–∏–Ω–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
X_line = np.linspace(X.min(), X.max(), 100).reshape(-1, 1)
y_line_tree = tree_model.predict(X_line)
y_line_linear = linear_model.predict(X_line)

axes[0].plot(X_line, y_line_linear, 'r-', linewidth=2, 
             label=f'–õ–∏–Ω–µ–π–Ω–∞—è (R¬≤={r2_linear:.2f})')
axes[0].plot(X_line, y_line_tree, 'g-', linewidth=2, 
             label=f'–î–µ—Ä–µ–≤–æ (R¬≤={r2_tree:.2f})')

axes[0].set_title('üå≥ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π', fontsize=14, fontweight='bold')
axes[0].set_xlabel('–û–ø—ã—Ç (–≥–æ–¥—ã)')
axes[0].set_ylabel('–ó–∞—Ä–ø–ª–∞—Ç–∞ (—Ä—É–±)')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞
axes[1].set_title('üå≤ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π', fontsize=14, fontweight='bold')

plot_tree(tree_model, 
          filled=True,
          feature_names=['–û–ø—ã—Ç'],
          ax=axes[1],
          fontsize=10)
"""
plot_tree - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞

filled=True - —Ä–∞—Å–∫—Ä–∞—Å–∏—Ç—å —É–∑–ª—ã
feature_names - –∏–º–µ–Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ö–∞–∂–¥—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ = —É–∑–µ–ª –¥–µ—Ä–µ–≤–∞
–í–æ–ø—Ä–æ—Å –≤–≤–µ—Ä—Ö—É: "–û–ø—ã—Ç <= 2.5?"
–ï—Å–ª–∏ –î–ê ‚Üí –∏–¥—ë–º –≤–ª–µ–≤–æ
–ï—Å–ª–∏ –ù–ï–¢ ‚Üí –∏–¥—ë–º –≤–ø—Ä–∞–≤–æ
"""

axes[1].axis('off')

plt.tight_layout()
plt.show()

print("‚úì –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")



print("\n" + "="*60)
print("–ü–†–ò–ú–ï–† 2: –û–¥–æ–±—Ä–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞ (–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø)")
print("="*60)

print("""
–ó–ê–î–ê–ß–ê: –û–¥–æ–±—Ä–∏—Ç—å –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ –Ω–µ—Ç?

–ü–†–ò–ó–ù–ê–ö–ò:
- –í–æ–∑—Ä–∞—Å—Ç
- –î–æ—Ö–æ–¥ (—Ç—ã—Å. —Ä—É–±)

–†–ï–®–ï–ù–ò–ï:
- 1 = –û–¥–æ–±—Ä–∏—Ç—å
- 0 = –û—Ç–∫–∞–∑–∞—Ç—å
""")

# –°–æ–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
np.random.seed(42)

–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç = {
    '–í–æ–∑—Ä–∞—Å—Ç': np.random.randint(20, 60, 100),
    '–î–æ—Ö–æ–¥': np.random.randint(20, 150, 100),
}

# –ü—Ä–∞–≤–∏–ª–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è (–∫–æ–º–ø—å—é—Ç–µ—Ä –µ–≥–æ –ù–ï –∑–Ω–∞–µ—Ç):
# –û–¥–æ–±—Ä–∏—Ç—å –µ—Å–ª–∏: (–í–æ–∑—Ä–∞—Å—Ç > 25 –ò –î–æ—Ö–æ–¥ > 40) –ò–õ–ò (–î–æ—Ö–æ–¥ > 100)
–æ–¥–æ–±—Ä–µ–Ω–∏–µ = ((–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç['–í–æ–∑—Ä–∞—Å—Ç'] > 25) & 
             (–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç['–î–æ—Ö–æ–¥'] > 40)) | \
            (–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç['–î–æ—Ö–æ–¥'] > 100)

–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ'] = –æ–¥–æ–±—Ä–µ–Ω–∏–µ.astype(int)

df_–∫—Ä–µ–¥–∏—Ç = pd.DataFrame(–¥–∞–Ω–Ω—ã–µ_–∫—Ä–µ–¥–∏—Ç)

print(f"\n–°–æ–∑–¥–∞–Ω–æ {len(df_–∫—Ä–µ–¥–∏—Ç)} –∑–∞—è–≤–æ–∫")
print(f"–û–¥–æ–±—Ä–µ–Ω–æ: {df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ'].sum()}")
print(f"–û—Ç–∫–∞–∑–∞–Ω–æ: {len(df_–∫—Ä–µ–¥–∏—Ç) - df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ'].sum()}")

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
X = df_–∫—Ä–µ–¥–∏—Ç[['–í–æ–∑—Ä–∞—Å—Ç', '–î–æ—Ö–æ–¥']].values
y = df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ'].values

# –†–∞–∑–¥–µ–ª–∏—Ç—å
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# ============================================
# –î–ï–†–ï–í–û –î–õ–Ø –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–ò
# ============================================

print("\n–°–æ–∑–¥–∞—ë–º –¥–µ—Ä–µ–≤–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏...")

tree_clf = DecisionTreeClassifier(
    max_depth=3,
    random_state=42
)

tree_clf.fit(X_train, y_train)
print("‚úì –î–µ—Ä–µ–≤–æ –æ–±—É—á–µ–Ω–æ")

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
y_pred = tree_clf.predict(X_test)

# –û—Ü–µ–Ω–∫–∞
accuracy = accuracy_score(y_test, y_pred)
print(f"\n–¢–æ—á–Ω–æ—Å—Ç—å: {accuracy*100:.1f}%")

# ============================================
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–ò
# ============================================

print("\n–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –≥—Ä–∞–Ω–∏—Ü—ã —Ä–µ—à–µ–Ω–∏—è...")

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# –ì—Ä–∞—Ñ–∏–∫ 1: –î–∞–Ω–Ω—ã–µ –∏ —Ä–µ—à–µ–Ω–∏—è
axes[0].scatter(df_–∫—Ä–µ–¥–∏—Ç[df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ']==1]['–í–æ–∑—Ä–∞—Å—Ç'],
                df_–∫—Ä–µ–¥–∏—Ç[df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ']==1]['–î–æ—Ö–æ–¥'],
                c='green', s=100, alpha=0.6, label='–û–¥–æ–±—Ä–µ–Ω–æ')

axes[0].scatter(df_–∫—Ä–µ–¥–∏—Ç[df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ']==0]['–í–æ–∑—Ä–∞—Å—Ç'],
                df_–∫—Ä–µ–¥–∏—Ç[df_–∫—Ä–µ–¥–∏—Ç['–û–¥–æ–±—Ä–µ–Ω–∏–µ']==0]['–î–æ—Ö–æ–¥'],
                c='red', s=100, alpha=0.6, label='–û—Ç–∫–∞–∑–∞–Ω–æ')

axes[0].set_title('üí≥ –û–¥–æ–±—Ä–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤', fontsize=14, fontweight='bold')
axes[0].set_xlabel('–í–æ–∑—Ä–∞—Å—Ç')
axes[0].set_ylabel('–î–æ—Ö–æ–¥ (—Ç—ã—Å. —Ä—É–±)')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ 2: –î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π
axes[1].set_title('üå≤ –î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π', fontsize=14, fontweight='bold')

plot_tree(tree_clf,
          filled=True,
          feature_names=['–í–æ–∑—Ä–∞—Å—Ç', '–î–æ—Ö–æ–¥'],
          class_names=['–û—Ç–∫–∞–∑', '–û–¥–æ–±—Ä–µ–Ω–∏–µ'],
          ax=axes[1],
          fontsize=9)

axes[1].axis('off')

plt.tight_layout()
plt.show()

print("‚úì –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")

# ============================================
# –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø –î–ï–†–ï–í–ê
# ============================================

print("\n" + "="*60)
print("–ö–ê–ö –ß–ò–¢–ê–¢–¨ –î–ï–†–ï–í–û:")
print("="*60)

print("""
–ö–∞–∂–¥—ã–π —É–∑–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–æ–ø—Ä–æ—Å: –í–æ–∑—Ä–∞—Å—Ç <= 25? ‚îÇ  ‚Üê –£—Å–ª–æ–≤–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
‚îÇ samples = 80           ‚îÇ  ‚Üê –°–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤
‚îÇ value = [30, 50]       ‚îÇ  ‚Üê [–û—Ç–∫–∞–∑—ã, –û–¥–æ–±—Ä–µ–Ω–∏—è]
‚îÇ class = –û–¥–æ–±—Ä–µ–Ω–∏–µ      ‚îÇ  ‚Üê –ö–∞–∫–æ–π –∫–ª–∞—Å—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        /        \
    –î–ê (‚â§25)   –ù–ï–¢ (>25)

–¶–í–ï–¢ —É–∑–ª–∞:
- –ó–µ–ª—ë–Ω—ã–π = –±–æ–ª—å—à–µ –æ–¥–æ–±—Ä–µ–Ω–∏–π
- –ö—Ä–∞—Å–Ω—ã–π = –±–æ–ª—å—à–µ –æ—Ç–∫–∞–∑–æ–≤
- –ë–ª–µ–¥–Ω—ã–π = –ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ—Ä–æ–≤–Ω—É

–ì–õ–£–ë–ò–ù–ê –¥–µ—Ä–µ–≤–∞:
- –ö–æ—Ä–µ–Ω—å (–≤–µ—Ä—Ö) = –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
- –õ–∏—Å—Ç—å—è (–Ω–∏–∑) = —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
""")

# ============================================
# –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ö –ù–û–í–´–ú –î–ê–ù–ù–´–ú
# ============================================

print("\n" + "="*60)
print("–ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ö –ù–û–í–´–ú –ó–ê–Ø–í–ö–ê–ú:")
print("="*60)

–Ω–æ–≤—ã–µ_–∑–∞—è–≤–∫–∏ = np.array([
    [30, 50],   # 30 –ª–µ—Ç, 50 —Ç—ã—Å
    [22, 120],  # 22 –≥–æ–¥–∞, 120 —Ç—ã—Å
    [45, 30],   # 45 –ª–µ—Ç, 30 —Ç—ã—Å
])

–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è = tree_clf.predict(–Ω–æ–≤—ã–µ_–∑–∞—è–≤–∫–∏)
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ = tree_clf.predict_proba(–Ω–æ–≤—ã–µ_–∑–∞—è–≤–∫–∏)
"""
predict_proba - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: [[–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–æ—Ç–∫–∞–∑–∞, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–æ–¥–æ–±—Ä–µ–Ω–∏—è]]

–ü—Ä–∏–º–µ—Ä:
[0.2, 0.8] = 20% –æ—Ç–∫–∞–∑, 80% –æ–¥–æ–±—Ä–µ–Ω–∏–µ
"""

print("\n{:<10} {:<15} {:<15} {:<20}".format(
    "–í–æ–∑—Ä–∞—Å—Ç", "–î–æ—Ö–æ–¥", "–†–µ—à–µ–Ω–∏–µ", "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å"))
print("-" * 65)

for –∑–∞—è–≤–∫–∞, —Ä–µ—à–µ–Ω–∏–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å in zip(–Ω–æ–≤—ã–µ_–∑–∞—è–≤–∫–∏, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏):
    —Ä–µ—à–µ–Ω–∏–µ_—Ç–µ–∫—Å—Ç = "–û–î–û–ë–†–ò–¢–¨ ‚úì" if —Ä–µ—à–µ–Ω–∏–µ == 1 else "–û–¢–ö–ê–ó–ê–¢–¨ ‚úó"
    —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å = max(–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å) * 100
    
    print("{:<10} {:<15} {:<15} {:<20.1f}%".format(
        –∑–∞—è–≤–∫–∞[0], 
        f"{–∑–∞—è–≤–∫–∞[1]} —Ç—ã—Å",
        —Ä–µ—à–µ–Ω–∏–µ_—Ç–µ–∫—Å—Ç,
        —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å))

# ============================================
# –†–ï–ó–Æ–ú–ï
# ============================================

print("\n" + "="*60)
print("–†–ï–ó–Æ–ú–ï - –î–ï–†–ï–í–¨–Ø –†–ï–®–ï–ù–ò–ô:")
print("="*60)

print("""
–ß–¢–û –¢–ê–ö–û–ï:
- –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –±–ª–æ–∫-—Å—Ö–µ–º–∞
- –ó–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –æ –¥–∞–Ω–Ω—ã—Ö

–ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢:
1. –í—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –ø—Ä–∏–∑–Ω–∞–∫ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
2. –ó–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å (–ü—Ä–∏–∑–Ω–∞–∫ <= –∑–Ω–∞—á–µ–Ω–∏–µ?)
3. –î–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ 2 –≥—Ä—É–ø–ø—ã
4. –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
5. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ max_depth

–ü–†–ò–ú–ï–ù–ï–ù–ò–ï:
‚úì –†–µ–≥—Ä–µ—Å—Å–∏—è: DecisionTreeRegressor
‚úì –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: DecisionTreeClassifier

–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
+ –õ–µ–≥–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å
+ –†–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
+ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
+ –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ

–ù–ï–î–û–°–¢–ê–¢–ö–ò:
- –õ–µ–≥–∫–æ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è
- –ù–µ—Å—Ç–∞–±–∏–ª–µ–Ω
- –ù–µ —ç–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä—É–µ—Ç (–∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö)

–ü–ê–†–ê–ú–ï–¢–†–´:
- max_depth - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ (3-5 –æ–±—ã—á–Ω–æ)
- min_samples_split - –º–∏–Ω–∏–º—É–º –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- min_samples_leaf - –º–∏–Ω–∏–º—É–º –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –ª–∏—Å—Ç–µ

–ö–û–î:
from sklearn.tree import DecisionTreeRegressor

model = DecisionTreeRegressor(max_depth=3)
model.fit(X_train, y_train)
predictions = model.predict(X_test)
""")

print("\n –î–µ—Ä–µ–≤—å—è —Ä–µ—à–µ–Ω–∏–π –æ—Å–≤–æ–µ–Ω—ã!")
print("="*60)