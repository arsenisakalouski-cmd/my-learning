# 03_classification_simple.py - –ü—Ä–æ—Å—Ç–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

print("="*60)
print("–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø - –ü–†–û–°–¢–û–ô –ü–†–ò–ú–ï–†")
print("="*60)

# ============================================
# –ê–ù–ê–õ–û–ì–ò–Ø: –°–ü–ê–ú –ò–õ–ò –ù–ï –°–ü–ê–ú
# ============================================

print("""
–ó–ê–î–ê–ß–ê: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ø–∞–º –∏–ª–∏ –Ω–µ —Å–ø–∞–º

–ü–†–ò–ú–ï–†–´ –ü–ò–°–ï–ú:

–ù–ï –°–ü–ê–ú (0):
- "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?" - 3 —Å–ª–æ–≤–∞
- "–í—Å—Ç—Ä–µ—Ç–∏–º—Å—è –∑–∞–≤—Ç—Ä–∞ –≤ –∫–∞—Ñ–µ" - 4 —Å–ª–æ–≤–∞
- "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤" - 2 —Å–ª–æ–≤–∞

–°–ü–ê–ú (1):
- "–í–´–ò–ì–†–ê–õ –ú–ò–õ–õ–ò–û–ù –ó–ê–ë–ï–†–ò –î–ï–ù–¨–ì–ò –°–ï–ô–ß–ê–°!!!" - 10 —Å–ª–æ–≤
- "–°–†–û–ß–ù–û –ö–õ–ò–ö–ù–ò –ü–û–õ–£–ß–ò –ü–†–ò–ó –ë–ï–°–ü–õ–ê–¢–ù–û" - 8 —Å–ª–æ–≤
- "–ê–ö–¶–ò–Ø –°–ö–ò–î–ö–ê –†–ê–°–ü–†–û–î–ê–ñ–ê –ö–£–ü–ò" - 6 —Å–ª–æ–≤

–ó–ê–ö–û–ù–û–ú–ï–†–ù–û–°–¢–¨:
–°–ø–∞–º = –æ–±—ã—á–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (6+ —Å–ª–æ–≤)
–ù–µ —Å–ø–∞–º = –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (< 6 —Å–ª–æ–≤)

ML –Ω–∞–π–¥—ë—Ç —ç—Ç—É –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –°–ê–ú!
""")

# ============================================
# –°–û–ó–î–ê–ù–ò–ï –î–ê–ù–ù–´–•
# ============================================

print("\n–°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –æ –ø–∏—Å—å–º–∞—Ö:")

# X = –¥–ª–∏–Ω–∞ –ø–∏—Å—å–º–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤)
# y = –∫–ª–∞—Å—Å (0 = –Ω–µ —Å–ø–∞–º, 1 = —Å–ø–∞–º)

X = np.array([
    [3],   # –Ω–µ —Å–ø–∞–º
    [4],   # –Ω–µ —Å–ø–∞–º
    [2],   # –Ω–µ —Å–ø–∞–º
    [5],   # –Ω–µ —Å–ø–∞–º
    [3],   # –Ω–µ —Å–ø–∞–º
    [10],  # —Å–ø–∞–º
    [8],   # —Å–ø–∞–º
    [9],   # —Å–ø–∞–º
    [7],   # —Å–ø–∞–º
    [11],  # —Å–ø–∞–º
])

y = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1])
#            ‚Üë–Ω–µ —Å–ø–∞–º‚Üë      ‚Üë  —Å–ø–∞–º  ‚Üë

print("\n–ü—Ä–∏–º–µ—Ä—ã –ø–∏—Å–µ–º:")
for i, (–¥–ª–∏–Ω–∞, –∫–ª–∞—Å—Å) in enumerate(zip(X.flatten(), y)):
    —Ç–∏–ø = "–ù–ï –°–ü–ê–ú" if –∫–ª–∞—Å—Å == 0 else "–°–ü–ê–ú"
    print(f"  –ü–∏—Å—å–º–æ {i+1}: {–¥–ª–∏–Ω–∞} —Å–ª–æ–≤ ‚Üí {—Ç–∏–ø}")

# ============================================
# –†–ê–ó–î–ï–õ–ï–ù–ò–ï –ù–ê –û–ë–£–ß–ï–ù–ò–ï –ò –¢–ï–°–¢
# ============================================

print("\n–†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ:")

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)
"""
–ë–µ—Ä—ë–º 70% –ø–∏—Å–µ–º - —É—á–∏–º—Å—è –Ω–∞ –Ω–∏—Ö
–ë–µ—Ä—ë–º 30% –ø–∏—Å–µ–º - –ø—Ä–æ–≤–µ—Ä—è–µ–º
"""

print(f"  –û–±—É—á–µ–Ω–∏–µ: {len(X_train)} –ø–∏—Å–µ–º")
print(f"  –¢–µ—Å—Ç: {len(X_test)} –ø–∏—Å–µ–º")

# ============================================
# –°–û–ó–î–ê–ù–ò–ï –ò –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ò
# ============================================

print("\n–°–æ–∑–¥–∞—ë–º –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:")

model = LogisticRegression()
"""
LogisticRegression - –º–æ–¥–µ–ª—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
(–¥–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–Ω–æ–µ, –Ω–æ —ç—Ç–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏!)

–û–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç –≥—Ä–∞–Ω–∏—Ü—É –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏:
"–ï—Å–ª–∏ —Å–ª–æ–≤ > 6 ‚Üí —Å–ø–∞–º, –∏–Ω–∞—á–µ –Ω–µ —Å–ø–∞–º"
"""

print("  ‚úì –ú–æ–¥–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞")

# –û–±—É—á–µ–Ω–∏–µ
model.fit(X_train, y_train)
print("  ‚úì –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞")

# ============================================
# –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø
# ============================================

print("\n–î–µ–ª–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:")

y_pred = model.predict(X_test)

print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:")
for i, (–¥–ª–∏–Ω–∞, —Ä–µ–∞–ª—å–Ω—ã–π, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π) in enumerate(zip(
    X_test.flatten(), y_test, y_pred
)):
    —Ä–µ–∞–ª—å–Ω—ã–π_—Ç–∏–ø = "–ù–ï –°–ü–ê–ú" if —Ä–µ–∞–ª—å–Ω—ã–π == 0 else "–°–ü–ê–ú"
    –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π_—Ç–∏–ø = "–ù–ï –°–ü–ê–ú" if –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π == 0 else "–°–ü–ê–ú"
    –ø—Ä–∞–≤–∏–ª—å–Ω–æ = "‚úì" if —Ä–µ–∞–ª—å–Ω—ã–π == –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π else "‚úó"
    
    print(f"  {–¥–ª–∏–Ω–∞} —Å–ª–æ–≤: —Ä–µ–∞–ª—å–Ω–æ {—Ä–µ–∞–ª—å–Ω—ã–π_—Ç–∏–ø}, "
          f"–º–æ–¥–µ–ª—å: {–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π_—Ç–∏–ø} {–ø—Ä–∞–≤–∏–ª—å–Ω–æ}")

# ============================================
# –û–¶–ï–ù–ö–ê –ö–ê–ß–ï–°–¢–í–ê
# ============================================

print("\n–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:")

accuracy = accuracy_score(y_test, y_pred)
"""
Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å) = –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

–§–æ—Ä–º—É–ª–∞: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ / –≤—Å–µ–≥–æ

–ü—Ä–∏–º–µ—Ä:
3 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ 3 ‚Üí 100% (1.0)
2 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ 3 ‚Üí 67% (0.67)
"""

print(f"  –¢–æ—á–Ω–æ—Å—Ç—å: {accuracy*100:.0f}%")
print(f"  ({int(accuracy * len(y_test))} –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ {len(y_test)})")

# ============================================
# –ü–†–û–í–ï–†–ö–ê –ù–ê –ù–û–í–´–• –î–ê–ù–ù–´–•
# ============================================

print("\n–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–æ–≤—ã—Ö –ø–∏—Å—å–º–∞—Ö:")

–Ω–æ–≤—ã–µ_–ø–∏—Å—å–º–∞ = np.array([
    [4],   # –∫–æ—Ä–æ—Ç–∫–æ–µ
    [9],   # –¥–ª–∏–Ω–Ω–æ–µ
    [2],   # –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ–µ
    [12],  # –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω–æ–µ
])

–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è = model.predict(–Ω–æ–≤—ã–µ_–ø–∏—Å—å–º–∞)

print("\n–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏:")
for –¥–ª–∏–Ω–∞, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ in zip(–Ω–æ–≤—ã–µ_–ø–∏—Å—å–º–∞.flatten(), –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è):
    —Ç–∏–ø = "–ù–ï –°–ü–ê–ú" if –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ == 0 else "–°–ü–ê–ú"
    print(f"  {–¥–ª–∏–Ω–∞} —Å–ª–æ–≤ ‚Üí {—Ç–∏–ø}")

# ============================================
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
# ============================================

print("\n–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:")

plt.figure(figsize=(12, 5))

# –ì—Ä–∞—Ñ–∏–∫ 1: –î–∞–Ω–Ω—ã–µ –∏ –≥—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏—è
plt.subplot(1, 2, 1)

# –ù–µ —Å–ø–∞–º (—Å–∏–Ω–∏–µ —Ç–æ—á–∫–∏)
not_spam = X[y == 0]
plt.scatter(not_spam, [0]*len(not_spam), s=200, 
            color='blue', label='–ù–ï –°–ü–ê–ú', alpha=0.6)

# –°–ø–∞–º (–∫—Ä–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏)
spam = X[y == 1]
plt.scatter(spam, [1]*len(spam), s=200, 
            color='red', label='–°–ü–ê–ú', alpha=0.6)

# –ì—Ä–∞–Ω–∏—Ü–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ 6 —Å–ª–æ–≤)
plt.axvline(x=6, color='green', linestyle='--', 
            linewidth=3, label='–ì—Ä–∞–Ω–∏—Ü–∞ (~6 —Å–ª–æ–≤)')

plt.title('üìß –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∏—Å–µ–º', fontsize=14, fontweight='bold')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤', fontsize=12)
plt.yticks([0, 1], ['–ù–ï –°–ü–ê–ú', '–°–ü–ê–ú'])
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ 2: –¢–æ—á–Ω–æ—Å—Ç—å
plt.subplot(1, 2, 2)

–ø—Ä–∞–≤–∏–ª—å–Ω–æ = int(accuracy * len(y_test))
–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ = len(y_test) - –ø—Ä–∞–≤–∏–ª—å–Ω–æ

plt.bar(['–ü—Ä–∞–≤–∏–ª—å–Ω–æ', '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'], 
        [–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ],
        color=['green', 'red'], alpha=0.6)

plt.title('üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã', fontsize=14, fontweight='bold')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', fontsize=12)
plt.ylim(0, len(y_test) + 1)

for i, v in enumerate([–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ]):
    plt.text(i, v + 0.1, str(v), ha='center', 
             fontweight='bold', fontsize=14)

plt.tight_layout()
plt.show()

# ============================================
# –†–ï–ó–Æ–ú–ï
# ============================================

print("\n" + "="*60)
print("–†–ï–ó–Æ–ú–ï - –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø:")
print("="*60)

print("""
–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø = –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ö–ê–¢–ï–ì–û–†–ò–ò

–ü–†–ò–ú–ï–†–´ –ó–ê–î–ê–ß:
- –°–ø–∞–º –∏–ª–∏ –Ω–µ —Å–ø–∞–º
- –ö–æ—à–∫–∞ –∏–ª–∏ —Å–æ–±–∞–∫–∞
- –ë–æ–ª–µ–Ω –∏–ª–∏ –∑–¥–æ—Ä–æ–≤
- –û–¥–æ–±—Ä–∏—Ç—å –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ –Ω–µ—Ç

–û–¢–õ–ò–ß–ò–ï –û–¢ –†–ï–ì–†–ï–°–°–ò–ò:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –†–ï–ì–†–ï–°–°–ò–Ø     ‚îÇ  –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º   ‚îÇ –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º    ‚îÇ
‚îÇ –ß–ò–°–õ–û           ‚îÇ –ö–ê–¢–ï–ì–û–†–ò–Æ        ‚îÇ
‚îÇ                 ‚îÇ                  ‚îÇ
‚îÇ –ü—Ä–∏–º–µ—Ä—ã:        ‚îÇ –ü—Ä–∏–º–µ—Ä—ã:         ‚îÇ
‚îÇ - –¶–µ–Ω–∞          ‚îÇ - –°–ø–∞–º/–Ω–µ —Å–ø–∞–º   ‚îÇ
‚îÇ - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞   ‚îÇ - –î–∞/–Ω–µ—Ç         ‚îÇ
‚îÇ - –í–æ–∑—Ä–∞—Å—Ç       ‚îÇ - –¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ö–û–î (–ü–û–ß–¢–ò –¢–û–¢ –ñ–ï!):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ X = –ø—Ä–∏–∑–Ω–∞–∫–∏                   ‚îÇ
‚îÇ y = –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (0, 1, 2...)    ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ model = LogisticRegression()  ‚îÇ
‚îÇ model.fit(X_train, y_train)   ‚îÇ
‚îÇ predictions = model.predict(X)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ú–ï–¢–†–ò–ö–ê:
Accuracy = –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ / –≤—Å–µ–≥–æ
–ß–µ–º –±–ª–∏–∂–µ –∫ 100% - —Ç–µ–º –ª—É—á—à–µ!
""")

print("\n –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Å–≤–æ–µ–Ω–∞!")
print("="*60)