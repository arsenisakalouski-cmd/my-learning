# 04_dashboard.py - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ° (ĞŸĞĞ”Ğ ĞĞ‘ĞĞ)

import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑÑ‚Ğ¸Ğ»Ñ
sns.set_theme(style="white")
plt.rcParams['figure.facecolor'] = 'white'

print("="*60)
print("Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• Ğ”ĞĞ¨Ğ‘ĞĞ Ğ”Ğ")
print("="*60)

# ============================================
# Ğ—ĞĞ“Ğ Ğ£Ğ—ĞšĞ Ğ”ĞĞĞĞ«Ğ¥
# ============================================

print("\n1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ...")

tips = sns.load_dataset('tips')
tips['tip_percent'] = (tips['tip'] / tips['total_bill']) * 100

print(f"âœ“ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾ {len(tips)} Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹")

# ============================================
# Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• Ğ”ĞĞ¨Ğ‘ĞĞ Ğ”Ğ
# ============================================

print("\n2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´...")

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆÑƒÑ Ñ„Ğ¸Ğ³ÑƒÑ€Ñƒ
fig = plt.figure(figsize=(18, 12))

# ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
fig.suptitle('ğŸ“Š Ğ”ĞĞ¨Ğ‘ĞĞ Ğ” ĞĞĞĞ›Ğ˜Ğ—Ğ Ğ§ĞĞ•Ğ’Ğ«Ğ¥ Ğ’ Ğ Ğ•Ğ¡Ğ¢ĞĞ ĞĞĞ•', 
             fontsize=20, fontweight='bold', y=0.98)

"""
Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ Ğ”ĞĞ¨Ğ‘ĞĞ Ğ”Ğ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 1    â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 2    â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 3    â”‚
â”‚  (Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹)   â”‚  (Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹)   â”‚  (ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 4    â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 5    â”‚  Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº 6    â”‚
â”‚  (ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹)   â”‚  (ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹)   â”‚  (ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 1: Ğ¡Ğ’Ğ¯Ğ—Ğ¬ Ğ¡Ğ§ĞĞ¢Ğ Ğ˜ Ğ§ĞĞ•Ğ’Ğ«Ğ¥ (Ğ‘ĞĞ›Ğ¬Ğ¨ĞĞ™)
# ============================================

ax1 = plt.subplot(2, 3, 1)
"""
subplot(2, 3, 1) Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚:
2 ÑÑ‚Ñ€Ğ¾ĞºĞ¸, 3 ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ°, Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ½Ğ¾Ğ¼ĞµÑ€ 1

ĞÑƒĞ¼ĞµÑ€Ğ°Ñ†Ğ¸Ñ:
1  2  3
4  5  6
"""

sns.scatterplot(data=tips, x='total_bill', y='tip', 
                hue='time', size='size', sizes=(50, 200),
                alpha=0.6, ax=ax1)

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¸Ğ½Ğ¸Ñ Ñ‚Ñ€ĞµĞ½Ğ´Ğ°
sns.regplot(data=tips, x='total_bill', y='tip', 
            scatter=False, color='red', ax=ax1)

ax1.set_title('ğŸ’° Ğ¡Ğ²ÑĞ·ÑŒ ÑÑ‡Ñ‘Ñ‚Ğ° Ğ¸ Ñ‡Ğ°ĞµĞ²Ñ‹Ñ…', fontweight='bold', fontsize=12)
ax1.set_xlabel('Ğ¡Ñ‡Ñ‘Ñ‚ ($)')
ax1.set_ylabel('Ğ§Ğ°ĞµĞ²Ñ‹Ğµ ($)')
ax1.grid(True, alpha=0.3)

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 2: Ğ§ĞĞ•Ğ’Ğ«Ğ• ĞŸĞ Ğ”ĞĞ¯Ğœ (Ğ‘ĞĞ›Ğ¬Ğ¨ĞĞ™)
# ============================================

ax2 = plt.subplot(2, 3, 2)

sns.boxplot(data=tips, x='day', y='tip', hue='time', ax=ax2)

ax2.set_title('ğŸ“… Ğ§Ğ°ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼ Ğ½ĞµĞ´ĞµĞ»Ğ¸', fontweight='bold', fontsize=12)
ax2.set_xlabel('Ğ”ĞµĞ½ÑŒ')
ax2.set_ylabel('Ğ§Ğ°ĞµĞ²Ñ‹Ğµ ($)')
ax2.legend(title='Ğ’Ñ€ĞµĞ¼Ñ', loc='upper left')

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 3: Ğ¡Ğ Ğ•Ğ”ĞĞ˜Ğ• ĞŸĞĞšĞĞ—ĞĞ¢Ğ•Ğ›Ğ˜ (KPI)
# ============================================

ax3 = plt.subplot(2, 3, 3)
ax3.axis('off')  # Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¾ÑĞ¸

# Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ KPI
total_records = len(tips)
avg_bill = tips['total_bill'].mean()
avg_tip = tips['tip'].mean()
avg_percent = tips['tip_percent'].mean()
max_tip = tips['tip'].max()

# ĞĞ°Ñ€Ğ¸ÑĞ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚ Ñ KPI
kpi_text = f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ĞšĞ›Ğ®Ğ§Ğ•Ğ’Ğ«Ğ• ĞœĞ•Ğ¢Ğ Ğ˜ĞšĞ˜    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Ğ’ÑĞµĞ³Ğ¾ Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹: {total_records}

ğŸ’µ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ ÑÑ‡Ñ‘Ñ‚: ${avg_bill:.2f}

ğŸ’° Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğµ Ñ‡Ğ°ĞµĞ²Ñ‹Ğµ: ${avg_tip:.2f}

ğŸ“ˆ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ %: {avg_percent:.1f}%

ğŸ† ĞœĞ°ĞºÑ. Ñ‡Ğ°ĞµĞ²Ñ‹Ğµ: ${max_tip:.2f}

â­ Ğ›ÑƒÑ‡ÑˆĞ¸Ğ¹ Ğ´ĞµĞ½ÑŒ: {tips.groupby('day')['tip'].mean().idxmax()}
"""

ax3.text(0.1, 0.5, kpi_text, fontsize=11, 
         verticalalignment='center', fontfamily='monospace',
         bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.3))

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 4: Ğ ĞĞ¡ĞŸĞ Ğ•Ğ”Ğ•Ğ›Ğ•ĞĞ˜Ğ• ĞŸĞ ĞĞ¦Ğ•ĞĞ¢ĞĞ’
# ============================================

ax4 = plt.subplot(2, 3, 4)

sns.histplot(data=tips, x='tip_percent', kde=True, 
             bins=20, color='coral', ax=ax4)

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¸Ğ½Ğ¸Ñ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ°
ax4.axvline(x=15, color='red', linestyle='--', 
            linewidth=2, label='Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ 15%')
ax4.axvline(x=tips['tip_percent'].mean(), color='green', 
            linestyle='--', linewidth=2, label='Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ')

ax4.set_title('ğŸ“Š Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ % Ñ‡Ğ°ĞµĞ²Ñ‹Ñ…', fontweight='bold', fontsize=12)
ax4.set_xlabel('ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ Ñ‡Ğ°ĞµĞ²Ñ‹Ñ… (%)')
ax4.set_ylabel('Ğ§Ğ°ÑÑ‚Ğ¾Ñ‚Ğ°')
ax4.legend()
ax4.grid(True, alpha=0.3, axis='y')

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 5: Ğ¢Ğ•ĞŸĞ›ĞĞ’ĞĞ¯ ĞšĞĞ Ğ¢Ğ
# ============================================

ax5 = plt.subplot(2, 3, 5)

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ pivot table
pivot = tips.pivot_table(values='tip', index='day', 
                         columns='time', aggfunc='mean')

sns.heatmap(pivot, annot=True, fmt='.2f', 
            cmap='YlGnBu', ax=ax5, cbar_kws={'label': 'Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğµ ($)'})

ax5.set_title('ğŸ—“ï¸ Ğ¢ĞµĞ¿Ğ»Ğ¾Ğ²Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° Ñ‡Ğ°ĞµĞ²Ñ‹Ñ…', fontweight='bold', fontsize=12)
ax5.set_xlabel('Ğ’Ñ€ĞµĞ¼Ñ')
ax5.set_ylabel('Ğ”ĞµĞ½ÑŒ')

# ============================================
# Ğ“Ğ ĞĞ¤Ğ˜Ğš 6: Ğ ĞĞ—ĞœĞ•Ğ  ĞšĞĞœĞŸĞĞĞ˜Ğ™
# ============================================

ax6 = plt.subplot(2, 3, 6)

# ĞŸĞ¾Ğ´ÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ñ‹
size_counts = tips['size'].value_counts().sort_index()

# Ğ¡Ñ‚Ğ¾Ğ»Ğ±Ñ‡Ğ°Ñ‚Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
bars = ax6.bar(size_counts.index, size_counts.values, 
               color='skyblue', edgecolor='black', alpha=0.7)

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ½Ğ° ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ñ‹
for bar in bars:
    height = bar.get_height()
    ax6.text(bar.get_x() + bar.get_width()/2., height,
             f'{int(height)}',
             ha='center', va='bottom', fontweight='bold')

ax6.set_title('ğŸ‘¥ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¹', fontweight='bold', fontsize=12)
ax6.set_xlabel('ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞº')
ax6.set_ylabel('Ğ§Ğ°ÑÑ‚Ğ¾Ñ‚Ğ°')
ax6.grid(True, alpha=0.3, axis='y')

# ============================================
# Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞĞ¯ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ
# ============================================

plt.tight_layout()

# Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´
plt.savefig('dashboard.png', dpi=150, bbox_inches='tight')
print("\nâœ“ Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½ Ğ² dashboard.png")

# ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ
plt.show()

print("\nâœ… Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ ÑĞ¾Ğ·Ğ´Ğ°Ğ½!")
print("="*60)