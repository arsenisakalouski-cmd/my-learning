# 01_real_data_problems.py - –ü—Ä–æ–±–ª–µ–º—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

sns.set_theme()
np.random.seed(42)

print("="*60)
print("–†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï - –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã")
print("="*60)

print("""

–ò–î–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï (–≤ —É—á–µ–±–Ω–∏–∫–∞—Ö):
‚úì –ù–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤
‚úì –í—Å–µ —á–∏—Å–ª–∞
‚úì –ù–µ—Ç –æ—à–∏–±–æ–∫
‚úì –ö—Ä–∞—Å–∏–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï (–≤ –∂–∏–∑–Ω–∏):
‚úó –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (NaN)
‚úó –í—ã–±—Ä–æ—Å—ã (outliers)
‚úó –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–º–µ—Å—Ç–æ —á–∏—Å–µ–ª
‚úó –†–∞–∑–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚úó –î—É–±–ª–∏–∫–∞—Ç—ã
‚úó –û–ø–µ—á–∞—Ç–∫–∏

–ü–†–ò–ú–ï–†–´:

–í–æ–∑—Ä–∞—Å—Ç: [25, 30, NaN, 35, 999]  ‚Üê 999 = –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞
–ü–æ–ª: ["–ú", "–ñ", "–º", "male"]     ‚Üê —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
–ó–∞—Ä–ø–ª–∞—Ç–∞: [50000, NaN, 1000000]  ‚Üê –ø—Ä–æ–ø—É—Å–∫, –≤—ã–±—Ä–æ—Å
–ì–æ—Ä–æ–¥: ["–ú–æ—Å–∫–≤–∞", "–ú–æ—Å–∫–≤–∞ ", "–ú–û–°–ö–í–ê"] ‚Üê –¥—É–±–ª–∏–∫–∞—Ç—ã
""")



print("\n" + "="*60)
print("–°–æ–∑–¥–∞—ë–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≥—Ä—è–∑–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç")
print("="*60)

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏
n_samples = 200

data = {
    '–í–æ–∑—Ä–∞—Å—Ç': np.random.randint(18, 70, n_samples),
    '–ó–∞—Ä–ø–ª–∞—Ç–∞': np.random.randint(30000, 200000, n_samples),
    '–û–ø—ã—Ç': np.random.randint(0, 30, n_samples),
    '–ì–æ—Ä–æ–¥': np.random.choice(['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫'], n_samples),
    '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': np.random.choice(['–í—ã—Å—à–µ–µ', '–°—Ä–µ–¥–Ω–µ–µ', '–ù–µ–ø–æ–ª–Ω–æ–µ –≤—ã—Å—à–µ–µ'], n_samples)
}

df = pd.DataFrame(data)

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º—ã:

# 1. –ü–†–û–ü–£–°–ö–ò (NaN)
# –°–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª—è–µ–º 10% –∑–Ω–∞—á–µ–Ω–∏–π
"""
NaN (Not a Number) - –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–∏—á–∏–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏:
- –ß–µ–ª–æ–≤–µ–∫ –Ω–µ –∑–∞–ø–æ–ª–Ω–∏–ª –ø–æ–ª–µ
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö  
- –î–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è–Ω—ã
"""
mask = np.random.random(n_samples) < 0.1  # 10% True
df.loc[mask, '–ó–∞—Ä–ø–ª–∞—Ç–∞'] = np.nan

mask = np.random.random(n_samples) < 0.05  # 5% True
df.loc[mask, '–í–æ–∑—Ä–∞—Å—Ç'] = np.nan

# 2. –í–´–ë–†–û–°–´ (Outliers)
"""
–í—ã–±—Ä–æ—Å - –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–µ–µ—Å—è –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö

–ü—Ä–∏—á–∏–Ω—ã:
- –û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ (999 –≤–º–µ—Å—Ç–æ 99)
- –†–µ–∞–ª—å–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (–º–∏–ª–ª–∏–æ–Ω–µ—Ä —Å—Ä–µ–¥–∏ –æ–±—ã—á–Ω—ã—Ö –ª—é–¥–µ–π)
"""
df.loc[5, '–ó–∞—Ä–ø–ª–∞—Ç–∞'] = 5000000  # –º–∏–ª–ª–∏–æ–Ω–µ—Ä
df.loc[10, '–í–æ–∑—Ä–∞—Å—Ç'] = 5        # –æ—à–∏–±–∫–∞
df.loc[15, '–û–ø—ã—Ç'] = 100         # –æ—à–∏–±–∫–∞

# 3. –î–£–ë–õ–ò–ö–ê–¢–´
"""
–î—É–±–ª–∏–∫–∞—Ç—ã - –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–ø–∏—Å–∏

–ü—Ä–∏—á–∏–Ω—ã:
- –ß–µ–ª–æ–≤–µ–∫ —Å–ª—É—á–∞–π–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª —Ñ–æ—Ä–º—É –¥–≤–∞–∂–¥—ã
- –û—à–∏–±–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
"""
df = pd.concat([df, df.iloc[:5]], ignore_index=True)

print(f"\n–°–æ–∑–¥–∞–Ω–æ {len(df)} –∑–∞–ø–∏—Å–µ–π")
print("\n–ü–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏:")
print(df.head(10))



print("\n" + "="*60)
print("–ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú –í –î–ê–ù–ù–´–•:")
print("="*60)

# 1. –ü—Ä–æ–ø—É—Å–∫–∏
print("\n1. –ü–†–û–ü–£–©–ï–ù–ù–´–ï –ó–ù–ê–ß–ï–ù–ò–Ø:")
print(df.isnull().sum())
"""
isnull() - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—É—é —è—á–µ–π–∫—É –Ω–∞ NaN
sum() - —Å—á–∏—Ç–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ True (–ø—Ä–æ–ø—É—Å–∫–æ–≤)

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
–í–æ–∑—Ä–∞—Å—Ç       12
–ó–∞—Ä–ø–ª–∞—Ç–∞      23
–û–ø—ã—Ç           0
"""

print("\n–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤:")
print((df.isnull().sum() / len(df) * 100).round(2))

# 2. –î—É–±–ª–∏–∫–∞—Ç—ã
duplicates = df.duplicated().sum()
"""
duplicated() - –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏
sum() - —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
"""
print(f"\n2. –î–£–ë–õ–ò–ö–ê–¢–´: {duplicates} —Å—Ç—Ä–æ–∫")

# 3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤–∏–¥–∏–º –≤—ã–±—Ä–æ—Å—ã)
print("\n3. –°–¢–ê–¢–ò–°–¢–ò–ö–ê (–∏—â–µ–º –≤—ã–±—Ä–æ—Å—ã):")
print(df.describe())
"""
describe() –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- min/max (–µ—Å–ª–∏ min=5 –∏–ª–∏ max=5000000 - —Å—Ç—Ä–∞–Ω–Ω–æ!)
- mean vs median (–µ—Å–ª–∏ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è - –≤—ã–±—Ä–æ—Å—ã!)
- std (–±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å)
"""



print("\n–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–±–ª–µ–º—ã...")

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# –ì—Ä–∞—Ñ–∏–∫ 1: –ü—Ä–æ–ø—É—Å–∫–∏
missing_data = df.isnull().sum()
axes[0, 0].bar(missing_data.index, missing_data.values, color='red', alpha=0.7)
axes[0, 0].set_title('‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è', fontweight='bold')
axes[0, 0].set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
axes[0, 0].tick_params(axis='x', rotation=45)
axes[0, 0].grid(True, alpha=0.3, axis='y')

# –ì—Ä–∞—Ñ–∏–∫ 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ (–≤–∏–¥–Ω—ã –≤—ã–±—Ä–æ—Å—ã)
axes[0, 1].hist(df['–í–æ–∑—Ä–∞—Å—Ç'].dropna(), bins=20, 
                color='skyblue', edgecolor='black')
axes[0, 1].set_title('üìä –í–æ–∑—Ä–∞—Å—Ç (–µ—Å—Ç—å –≤—ã–±—Ä–æ—Å 5 –ª–µ—Ç!)', fontweight='bold')
axes[0, 1].set_xlabel('–í–æ–∑—Ä–∞—Å—Ç')
axes[0, 1].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
axes[0, 1].grid(True, alpha=0.3, axis='y')

# –ì—Ä–∞—Ñ–∏–∫ 3: Box plot –∑–∞—Ä–ø–ª–∞—Ç (–≤—ã–±—Ä–æ—Å—ã –≤–∏–¥–Ω—ã)
axes[1, 0].boxplot(df['–ó–∞—Ä–ø–ª–∞—Ç–∞'].dropna(), vert=True)
"""
Box plot –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ = –æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –¥–∞–Ω–Ω—ã—Ö
- –¢–æ—á–∫–∏ –≤–Ω–µ = –í–´–ë–†–û–°–´!
"""
axes[1, 0].set_title('üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞ (–≤–∏–¥–µ–Ω –≤—ã–±—Ä–æ—Å 5 –º–ª–Ω!)', fontweight='bold')
axes[1, 0].set_ylabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')
axes[1, 0].grid(True, alpha=0.3, axis='y')

# –ì—Ä–∞—Ñ–∏–∫ 4: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
city_counts = df['–ì–æ—Ä–æ–¥'].value_counts()
axes[1, 1].bar(city_counts.index, city_counts.values, color='green', alpha=0.7)
axes[1, 1].set_title('üèôÔ∏è –ì–æ—Ä–æ–¥–∞ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫)', fontweight='bold')
axes[1, 1].set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
axes[1, 1].tick_params(axis='x', rotation=45)
axes[1, 1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.show()



print("\n" + "="*60)
print("–†–ï–ó–Æ–ú–ï:")
print("="*60)

print(f"""
–ù–ê–ô–î–ï–ù–û –ü–†–û–ë–õ–ï–ú –í –î–ê–ù–ù–´–•:

1. –ü–†–û–ü–£–°–ö–ò:
   - –í–æ–∑—Ä–∞—Å—Ç: {df['–í–æ–∑—Ä–∞—Å—Ç'].isnull().sum()} –ø—Ä–æ–ø—É—Å–∫–æ–≤
   - –ó–∞—Ä–ø–ª–∞—Ç–∞: {df['–ó–∞—Ä–ø–ª–∞—Ç–∞'].isnull().sum()} –ø—Ä–æ–ø—É—Å–∫–æ–≤

2. –í–´–ë–†–û–°–´:
   - –í–æ–∑—Ä–∞—Å—Ç –º–∏–Ω: {df['–í–æ–∑—Ä–∞—Å—Ç'].min()} (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 18+)
   - –ó–∞—Ä–ø–ª–∞—Ç–∞ –º–∞–∫—Å: {df['–ó–∞—Ä–ø–ª–∞—Ç–∞'].max():,.0f} (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)
   - –û–ø—ã—Ç –º–∞–∫—Å: {df['–û–ø—ã—Ç'].max()} (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)

3. –î–£–ë–õ–ò–ö–ê–¢–´: {duplicates} –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫

4. –ö–ê–¢–ï–ì–û–†–ò–ò: 
   - –ì–æ—Ä–æ–¥ (–Ω—É–∂–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å)
   - –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–Ω—É–∂–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å)

–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì: –û—á–∏—Å—Ç–∫–∞ —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º!
(–≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö)
""")

print("\n –ü—Ä–æ–±–ª–µ–º—ã –≤—ã—è–≤–ª–µ–Ω—ã!")
print("="*60)